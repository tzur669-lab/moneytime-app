<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>מתחבר...</title>
<style>
body{font-family:sans-serif;display:flex;align-items:center;justify-content:center;height:100vh;margin:0;background:#1E3A8A;color:white;text-align:center;flex-direction:column;gap:16px}
.spinner{width:40px;height:40px;border:4px solid rgba(255,255,255,.3);border-top-color:white;border-radius:50%;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
p{font-size:16px;opacity:.8}
</style>
</head>
<body>
<div class="spinner"></div>
<p>מחבר את חשבון Google...</p>
<script>
// חלץ את ה-token מה-hash
const hash = window.location.hash;
const params = new URLSearchParams(hash.substring(1));
const token = params.get('access_token');

if(token) {
  // שמור ב-localStorage כדי שהדף הראשי יקרא
  localStorage.setItem('gtoken', token);
  localStorage.setItem('syen', '1');
  localStorage.setItem('oauth_done', Date.now().toString());
  // חזור לדף הראשי
  window.location.href = 'index.html';
} else {
  // אין token — חזור בכל זאת
  document.querySelector('p').textContent = 'שגיאה בהתחברות. חוזר...';
  setTimeout(() => { window.location.href = 'index.html'; }, 2000);
}
</script>
</body>
</html>
